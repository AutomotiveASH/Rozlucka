<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rozlučka Lukáše Korce - Úkoly</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      padding: 20px;
      background: #f9f9f9;
      color: #333;
    }
    h1 {
      text-align: center;
      font-size: 2em;
      color: #222;
      margin-bottom: 30px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background-color: #fff;
      color: #000;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    th, td {
      padding: 10px;
      border: 1px solid #ddd;
      text-align: center;
    }
    input, textarea, button, select {
      padding: 10px;
      margin-top: 5px;
      width: 100%;
      border-radius: 4px;
      border: 1px solid #ccc;
    }
    form {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 30px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    button {
      background-color: #0057e7;
      color: white;
      font-weight: bold;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #0041b3;
    }
    .done {
      background-color: #d0f0c0;
    }
    .never {
      background-color: #f8d7da;
    }
  </style>
</head>
<body>
  <h1>Rozlučka Lukáše Korce – Úkoly</h1>

  <form id="taskForm">
    <label>Název úkolu:</label>
    <input type="text" id="task" required>

    <label>Odpovědná osoba:</label>
    <select id="responsible" required>
      <option value="">-- vyber osobu --</option>
      <option value="Adam">Adam</option>
      <option value="Adrian">Adrian</option>
      <option value="Dominik">Dominik</option>
      <option value="Pehe">Pehe</option>
      <option value="Vlasta">Vlasta</option>
      <option value="Pepa Janota">Pepa Janota</option>
      <option value="Pepa Vlk">Pepa Vlk</option>
      <option value="Tomáš Záky">Tomáš Záky</option>
      <option value="Tomáš Beránek">Tomáš Beránek</option>
    </select>

    <label>Deadline:</label>
    <input type="date" id="deadline" required>

    <label>Poznámka:</label>
    <textarea id="note"></textarea>

    <button type="submit">Přidat úkol</button>
  </form>

  <table>
    <thead>
      <tr>
        <th>Úkol</th>
        <th>Odpovědný</th>
        <th>Deadline</th>
        <th>Poznámka</th>
        <th>Stav</th>
        <th>Akce</th>
      </tr>
    </thead>
    <tbody id="taskTable"></tbody>
  </table>

  <script>
    const form = document.getElementById('taskForm');
    const table = document.getElementById('taskTable');
    const taskList = [];

    function saveTasksToStorage() {
      localStorage.setItem('taskList', JSON.stringify(taskList));
    }

    function loadTasksFromStorage() {
      const data = localStorage.getItem('taskList');
      if (data) {
        const parsed = JSON.parse(data);
        parsed.forEach((task, index) => {
          taskList.push(task);
          addTaskToTable(task, index);
        });
      }
    }

    function addTaskToTable(task, index) {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td contenteditable="true" oninput="updateTask(${index})">${task.task}</td>
        <td>${task.responsible}</td>
        <td contenteditable="true" oninput="updateTask(${index})">${task.deadline}</td>
        <td contenteditable="true" oninput="updateTask(${index})">${task.note}</td>
        <td>
          <label><input type="radio" name="status${index}" onchange="setStatus(this, 'done', ${index})" ${task.status === 'done' ? 'checked' : ''}> Hotovo</label><br>
          <label><input type="radio" name="status${index}" onchange="setStatus(this, 'never', ${index})" ${task.status === 'never' ? 'checked' : ''}> NEBUDE</label>
        </td>
        <td>
          <button onclick="editTask(this)">Editovat</button>
          <button onclick="deleteTask(this, ${index})">Smazat</button>
        </td>
      `;
      if (task.status === 'done') row.classList.add('done');
      if (task.status === 'never') row.classList.add('never');
      table.appendChild(row);
    }

    function updateTask(index) {
      const row = table.rows[index];
      if (!row) return;
      const cells = row.querySelectorAll('td');
      taskList[index].task = cells[0].innerText;
      taskList[index].deadline = cells[2].innerText;
      taskList[index].note = cells[3].innerText;
      saveTasksToStorage();
    }

    function setStatus(radio, status, index) {
      const row = radio.closest('tr');
      row.classList.remove('done', 'never');
      row.classList.add(status);
      taskList[index].status = status;
      saveTasksToStorage();
    }

    function deleteTask(button, index) {
      taskList.splice(index, 1);
      saveTasksToStorage();
      location.reload();
    }

    function editTask(button) {
      const row = button.closest('tr');
      const cells = row.querySelectorAll('td');
      cells.forEach((cell, index) => {
        if (index < 4) cell.contentEditable = true;
      });
      row.style.backgroundColor = '#fff3cd';
    }

    form.addEventListener('submit', function(e) {
      e.preventDefault();

      const task = document.getElementById('task').value;
      const responsible = document.getElementById('responsible').value;
      const deadline = document.getElementById('deadline').value;
      const note = document.getElementById('note').value;

      const taskData = { task, responsible, deadline, note, status: null };
      const index = taskList.length;
      taskList.push(taskData);
      addTaskToTable(taskData, index);
      saveTasksToStorage();
      form.reset();
    });

    window.addEventListener('load', loadTasksFromStorage);
  </script>
</body>
</html>
